(this.webpackJsonpnpm=this.webpackJsonpnpm||[]).push([[0],[,,,,,,,,,,,,,,function(e,o,s){},function(e,o,s){},function(e,o,s){},,function(e,o,s){},function(e,o,s){},function(e,o,s){},function(e,o,s){},function(e,o,s){},function(e,o,s){},function(e,o,s){},function(e,o,s){},function(e,o,s){},function(e,o,s){"use strict";s.r(o);var t=s(1),i=s.n(t),n=s(6),a=s.n(n),r=(s(14),s(7)),m=(s(15),s(16),s.p+"static/media/zadigChess.ba50ba27.png"),c=s(0),l=function(e){return Object(c.jsxs)("div",{className:"header",children:[Object(c.jsx)("img",{src:"./"+m,className:"logo",alt:"logo"}),Object(c.jsxs)("div",{className:"title",children:["Chess Studies ",Object(c.jsx)("span",{className:"storageType",children:e.parentInfos.storageType})]})]})},u=s(3),v=s(4),g=s(2),d=s(9),p=s(8);s(18),s(19),s(20);function h(e){return 0===e?"":e>0?"+"+e:""+e}function f(e,o,s,t){var i="w"===t?"B":"W",n="",a="w"===t?o:e,r=a&&a.length>1?a[0]:"";return a.forEach((function(e){r!==e&&(n+="&nbsp;&nbsp;",r=e),n+=s[e+i]})),{__html:n}}var b=function(e){var o=e.scores.whiteJail,s=e.scores.blackJail,t=e.figCodes,i=e.side;return Object(c.jsxs)("div",{className:"jail ".concat("inversed"===e.boardPosition?"reverse":""," \n        ").concat("b"===e.side?"inversed"===e.boardPosition?"black":"white":"inversed"===e.boardPosition?"white":"black"),children:[Object(c.jsxs)("span",{className:"jail-yard",children:[Object(c.jsx)("span",{className:"player",children:"b"===e.side?e.pgnResume.Black:e.pgnResume.White}),Object(c.jsx)("span",{className:"score",children:"b"===e.side?h(e.scores.whiteScore):h(e.scores.blackScore)}),Object(c.jsx)("span",{className:"list",dangerouslySetInnerHTML:f(o,s,t,i)})]}),Object(c.jsx)("span",{className:"inverse-clickable",onClick:e.reverseBoard,dangerouslySetInnerHTML:{__html:"\u21f5"}})]})},w=function(e){return Object(c.jsxs)("div",{className:"board-zone ".concat(e.game.doReverseBoard?"inverse":""),children:[Object(c.jsx)(b,{side:"w",reverseBoard:e.reverseBoard,figCodes:e.game.figCodes,pgnResume:e.game.pgnResume,scores:e.game.scores}),Object(c.jsx)("div",{className:"board",children:e.game.data.map((function(o,s){return Object(c.jsx)(i.a.Fragment,{children:Object(c.jsx)("div",{"data-pos":s,className:"square "+o.squareColor,dangerouslySetInnerHTML:{__html:e.game.figCodes[o.fig]?e.game.figCodes[o.fig]:"&nbsp;"}},s)},s)}))}),Object(c.jsx)(b,{side:"b",reverseBoard:e.reverseBoard,figCodes:e.game.figCodes,pgnResume:e.game.pgnResume,scores:e.game.scores})]})},A=(s(21),s(22),function(e){return Object(c.jsx)("div",{className:"game-turns",children:Object(c.jsx)("ol",{children:e.turnsList.map((function(o,s){return Object(c.jsxs)("li",{children:[Object(c.jsx)("span",{onClick:e.movePGN,"data-turn":s+1,"data-side":"w",className:"turn-w ".concat(e.currentMove.number===s+1&&"w"===e.currentMove.side?"turn-current":""),children:o.w}),Object(c.jsx)("span",{onClick:e.movePGN,"data-turn":s+1,"data-side":"b",className:"turn-b ".concat(e.currentMove.number===s+1&&"b"===e.currentMove.side?"turn-current":""),children:o.b})]},s)}))})})}),j=(s(23),function(e){return Object(c.jsxs)("div",{className:"game-resume",children:[e.resume.Date," ",e.resume.White," vs ",e.resume.Black," ",e.resume.Result]})}),P=(s(24),function(e){return Object(c.jsxs)("div",{className:"moves-board",children:[Object(c.jsx)("span",{"data-move":"first",onClick:e.movePGN,children:Object(c.jsx)("img",{src:"data:image/gif;base64,R0lGODlhMQAnAMwAAAAAALKAP3+vxWaaxZnFxQAAPwAAZsW2kr+mecW8n18rAGw7E0YTAIxULDM1M5KTkplkLF8rP39CE2aarMW2pZnFv6W2xXKdxb+mpbKKWYxUU0YTZr+vn2w7ZsXFxQAAACH5BAEAAB4ALAAAAAAxACcAAAX/oCeOZGmeaKqubOu+cCzPdG1njnO1mEvBAQBgwEJsCKxDRPAKDlcIhgGpOigKTJeTmIoCplUFANsUck/eL/VkFZK1ZlRajWq7s60tmiEUgk12d2VPJXN+ayOBgnCEI4aHJYqLeXGOfH19fyKSkyx6Io+Za5ydK5+hoptimJhvlE+oqaR9rp5msaKztHi2ABMSrMFfFRDCrLWmZgkLxqkNzaUqesvQf8/NyNKV1Maa18LZKZ8e3MGaHt/HvMmN5MzmiOjg69rt7vAm6dHilSTlkPnUDTrj7x3AgLsGoih3rsS3cCjGmeDW0OG+iP1OUKtoEeIJiRoXcHTo0QRIjR3iF6HQQC8FhwcPLNiYSbOmzZs4c+rcGSMEADs=",className:"command-img",alt:"first"})}),Object(c.jsx)("span",{"data-move":"prev",onClick:e.movePGN,children:Object(c.jsx)("img",{src:"data:image/gif;base64,R0lGODlhIAAnALsAAAAAAH+vxQAAP7mXZqyDTCwAABkAAIavxYyvxbmXf6yDbBkAPywAP8XFxQAAAAAAACH5BAEAAA0ALAAAAAAgACcAAARzsMlJq7046827/2AoZsoxasQSnBhhCCtbuQAsU3Qd37l+Nz2fLCg8EYuiIxKkXHqaTg40ijIArtgsNTMoaL+2UPebDYu95O1mTDaL2Fr3G13eneBX+Qiv39P7fnl2N2OAdwWGdwyDPw0JCI2RkpOUlZYWEQA7",className:"command-img",alt:"prev"})}),Object(c.jsx)("span",{"data-move":"pause",className:"hidden",onClick:e.movePGN,children:"\u23f8"}),Object(c.jsx)("span",{"data-move":"next",onClick:e.movePGN,children:Object(c.jsx)("img",{src:"data:image/gif;base64,R0lGODlhJQAnALsAAAAAAMWvfz8AAGaXuUaArAAALAAAE3+XuT8AE8WvjGaArD8ALMWvhsXFxQAAAAAAACH5BAEAAA0ALAAAAAAlACcAAAR2sMlJq7046827/2AojhijkF+AEGgXCAbbai8Qz1lty3il7z2fAEAEBiU/4u2YVPJwTWcwKoUOi1hji1pcorjdpwhMLAy212zRPAOz2+nsG64GzOny8zRu1++xdz0/gYJXhIV9R0KHUwt+ihMJB5CUlZaXmJkkEQA7",className:"command-img",alt:"next"})}),Object(c.jsx)("span",{"data-move":"last",onClick:e.movePGN,children:Object(c.jsx)("img",{src:"data:image/gif;base64,R0lGODlhLwAnAMwAAAAAAGaaxcWvf8WaZrKAPz8AAJ+8xRM7bDlun5K2xQAAEwArXyxUjDM1M5KTkqW2xaWAP3KdxT99rL+vnyxkmVNUjD8rX7KKWcWpn8XFxQAAAAAAAAAAAAAAAAAAAAAAACH5BAEAABkALAAAAAAvACcAAAX/YCaOZGmeaKqubOu+cCzPdK1ihvu0V9NErcEhtxJYEiwCABAIAobFwgKpUjKdTyJKUABMq8sma7DMprjLL8oqXpHL0BM6TTWxsXAtaU4/3cdleSZ8fSV/boGCe12JaiOHKm+JZiOEZY4ZkCmSk3EZlpd1miicnUSgoSKjJ6Wmn4yTfasmraaogVOzJbWJChK3gRQQYXixAAoIr8ZlDJnEgMvIIsAAzc5X0LHS07CT1tdtkcbb3Mbf4MVl5OXehs+IvckloOeq7+KB65Xd1X73m/nkDepW79E/UuoEDmSWQheJN/rmMSpIwuEIMhEl9gODzU1GiRTddYyk8EyFFhZtEqiY4MDBDpUwY8qcSbOmzZohAAA7",className:"command-img",alt:"last"})})]})}),O=(s(25),function(e){return Object(c.jsx)("div",{className:"game-list",children:Object(c.jsx)("ol",{children:e.games.map((function(o,s){return Object(c.jsx)("li",{children:Object(c.jsxs)("div",{className:"list-element",children:[Object(c.jsxs)("span",{className:"list-element-text",children:[o.pgnResume.Event," ",o.pgnResume.Site," ",o.pgnResume.Date," ",Object(c.jsx)("br",{}),o.pgnResume.White," (",o.pgnResume.WhiteElo,") ","vs"," ",o.pgnResume.Black," (",o.pgnResume.BlackElo,")  ","=>"," ",o.pgnResume.Result]}),Object(c.jsx)("span",{className:"button choose","data-index":o.id,onClick:e.loadGame}),Object(c.jsx)("span",{className:"button delete ".concat(e.online?"":"hidden"),"data-index":o.id,onClick:e.deleteGame})]})},s)}))})})}),R=(s(26),function(e){return Object(c.jsxs)("div",{className:"game-menu",children:[Object(c.jsx)("div",{"data-target":"showMoves",className:"".concat(e.movesLoaded?"":"hidden"),onClick:e.menuMove,children:"Moves"}),Object(c.jsx)("div",{"data-target":"showList",onClick:e.menuMove,children:"Games list"}),Object(c.jsx)("div",{"data-target":"showInput",onClick:e.menuMove,children:"New game"})]})}),C=function(e){var o=e.game.status,s=e.statuses;return o===s.showInput?Object(c.jsxs)(i.a.Fragment,{children:[Object(c.jsx)(R,{menuMove:e.menuMove,movesLoaded:e.game.pgnHistory&&e.game.pgnHistory>1}),Object(c.jsxs)("div",{className:"info-zone",children:[Object(c.jsx)("h3",{className:"board-title",children:e.game.infosTitle}),Object(c.jsx)("textarea",{id:"game-input",className:"game-input",name:"pgn"}),Object(c.jsx)("button",{onClick:e.savePGN,children:"Go"})]})]}):o===s.showList?Object(c.jsxs)(i.a.Fragment,{children:[Object(c.jsx)(R,{menuMove:e.menuMove,movesLoaded:!!(e.game.pgnHistory&&e.game.pgnHistory.length>1)}),Object(c.jsxs)("div",{className:"list-zone",children:[Object(c.jsx)("h3",{className:"board-list-title",children:e.game.infosTitle}),Object(c.jsx)(O,{games:e.game.games,deleteGame:e.deleteGame,loadGame:e.loadGame,online:e.game.isRemote})]})]}):o===s.showMessage||o===s.inError||o===s.init?Object(c.jsxs)("div",{className:"info-zone",children:[Object(c.jsx)("h3",{className:"board-title",children:e.game.infosTitle}),Object(c.jsx)("p",{className:"infosMessage",children:e.game.infosMessage})]}):o===s.showMoves?Object(c.jsxs)(i.a.Fragment,{children:[Object(c.jsx)(R,{menuMove:e.menuMove,movesLoaded:e.game.pgnHistory&&e.game.pgnHistory>1}),Object(c.jsxs)("div",{className:"turns-zone",children:[Object(c.jsx)(j,{resume:e.game.pgnResume}),Object(c.jsx)(A,{turnsList:e.game.pgnGame,currentMove:e.game.move,movePGN:e.movePGN}),Object(c.jsx)(P,{movePGN:e.movePGN})]})]}):Object(c.jsxs)("div",{className:"info-zone",children:[Object(c.jsx)("h3",{className:"board-title",children:"404"}),Object(c.jsx)("p",{className:"infosMessage",children:"Sorry Buddy, I'm afraid we are lost !"})]})},x=function(e){return e!==e.toUpperCase()},S=function(e,o){for(var s=1;s<9;s++)if(s!==e.moveRow){var t={column:e.moveColumn,row:s};0!==e.comingFromRow&&t.row!==e.comingFromRow||""!==e.comingFromColumn&&t.column!==e.comingFromColumn||e.possiblePositions.push(t)}for(var i=0;i<8;i++)if(o[i]!==e.moveColumn){var n={column:o[i],row:e.moveRow};0!==e.comingFromRow&&n.row!==e.comingFromRow||""!==e.comingFromColumn&&n.column!==e.comingFromColumn||e.possiblePositions.push(n)}},y=function(e,o){"castle-king"===e.moveType?(e.possiblePositions.push({column:"e",row:"w"===e.moveSide?1:8}),e.additionalMove.possiblePositions.push({column:"h",row:"w"===e.moveSide?1:8}),e.moveType="move",e.additionalMove.moveType="move"):"castle-queen"===e.moveType?(e.possiblePositions.push({column:"e",row:"w"===e.moveSide?1:8}),e.additionalMove.possiblePositions.push({column:"a",row:"w"===e.moveSide?1:8}),e.moveType="move",e.additionalMove.moveType="move"):e.uniqueFigure=!0},N=function(e,o){if(4===e.moveRow&&"w"===e.moveSide&&"move"===e.moveType)e.possiblePositions.push({column:e.moveColumn,row:3}),e.possiblePositions.push({column:e.moveColumn,row:2});else if(5===e.moveRow&&"b"===e.moveSide&&"move"===e.moveType)e.possiblePositions.push({column:e.moveColumn,row:7}),e.possiblePositions.push({column:e.moveColumn,row:6});else if("move"===e.moveType)e.possiblePositions.push({column:e.moveColumn,row:"w"===e.moveSide?e.moveRow-1:e.moveRow+1});else if("take"===e.moveType)if(""!==e.comingFromColumn)e.possiblePositions.push({column:e.comingFromColumn,row:"w"===e.moveSide?e.moveRow-1:e.moveRow+1});else{var s=o.indexOf(e.moveColumn);0===s?e.possiblePositions.push({column:o[1],row:"w"===e.moveSide?e.moveRow-1:e.moveRow+1}):7===s?e.possiblePositions.push({column:o[6],row:"w"===e.moveSide?e.moveRow-1:e.moveRow+1}):(e.possiblePositions.push({column:o[s-1],row:"w"===e.moveSide?e.moveRow-1:e.moveRow+1}),e.possiblePositions.push({column:o[s+1],row:"w"===e.moveSide?e.moveRow-1:e.moveRow+1}))}else e.isError=!0},T=function(e,o){for(var s=e.moveRow,t=o.indexOf(e.moveColumn)+1,i=t+1,n=s+1,a=0;a<9;a++){if(i<9&&n<9){var r={column:o[i-1],row:n};0!==e.comingFromRow&&r.row!==e.comingFromRow||""!==e.comingFromColumn&&r.column!==e.comingFromColumn||e.possiblePositions.push(r)}i++,n++}i=t-1,n=s+1;for(var m=0;m<9;m++){if(i>0&&n<9){var c={column:o[i-1],row:n};0!==e.comingFromRow&&c.row!==e.comingFromRow||""!==e.comingFromColumn&&c.column!==e.comingFromColumn||e.possiblePositions.push(c)}i--,n++}i=t+1,n=s-1;for(var l=0;l<9;l++){if(i<9&&n>0){var u={column:o[i-1],row:n};0!==e.comingFromRow&&u.row!==e.comingFromRow||""!==e.comingFromColumn&&u.column!==e.comingFromColumn||e.possiblePositions.push(u)}i++,n--}i=t-1,n=s-1;for(var v=8;v>0;v--){if(i>0&&i>0){var g={column:o[i-1],row:n};0!==e.comingFromRow&&g.row!==e.comingFromRow||""!==e.comingFromColumn&&g.column!==e.comingFromColumn||e.possiblePositions.push(g)}i--,n--}},M=function(e,o){var s=e.moveRow,t=o.indexOf(e.moveColumn)+1;if(s-2>0&&t-1>0){var i={column:o[t-1-1],row:s-2};0!==e.comingFromRow&&i.row!==e.comingFromRow||""!==e.comingFromColumn&&i.column!==e.comingFromColumn||e.possiblePositions.push(i)}if(s-2>0&&t+1<9){var n={column:o[t+1-1],row:s-2};0!==e.comingFromRow&&n.row!==e.comingFromRow||""!==e.comingFromColumn&&n.column!==e.comingFromColumn||e.possiblePositions.push(n)}if(s+2<9&&t-1>0){var a={column:o[t-1-1],row:s+2};0!==e.comingFromRow&&a.row!==e.comingFromRow||""!==e.comingFromColumn&&a.column!==e.comingFromColumn||e.possiblePositions.push(a)}if(s+2<9&&t+1<9){var r={column:o[t+1-1],row:s+2};0!==e.comingFromRow&&r.row!==e.comingFromRow||""!==e.comingFromColumn&&r.column!==e.comingFromColumn||e.possiblePositions.push(r)}if(s-1>0&&t-2>0){var m={column:o[t-2-1],row:s-1};0!==e.comingFromRow&&m.row!==e.comingFromRow||""!==e.comingFromColumn&&m.column!==e.comingFromColumn||e.possiblePositions.push(m)}if(s-1>0&&t+2<9){var c={column:o[t+2-1],row:s-1};0!==e.comingFromRow&&c.row!==e.comingFromRow||""!==e.comingFromColumn&&c.column!==e.comingFromColumn||e.possiblePositions.push(c)}if(s+1<9&&t-2>0){var l={column:o[t-2-1],row:s+1};0!==e.comingFromRow&&l.row!==e.comingFromRow||""!==e.comingFromColumn&&l.column!==e.comingFromColumn||e.possiblePositions.push(l)}if(s+1<9&&t+2<9){var u={column:o[t+2-1],row:s+1};0!==e.comingFromRow&&u.row!==e.comingFromRow||""!==e.comingFromColumn&&u.column!==e.comingFromColumn||e.possiblePositions.push(u)}},k=function(e){return 0===e.number?0:2*(e.number-1)+("w"===e.side?1:2)},G=function(){function e(o){var s=this;Object(u.a)(this,e),this.initRemote=function(){var e="https://jsonblob.com/api/jsonBlob/"+s.key;return new Promise((function(o,s){var t=new XMLHttpRequest;t.open("GET",e),t.onload=function(){if(this.status>=200&&this.status<300)try{var e=JSON.parse(t.response);o(e)}catch(i){s(i)}else s(t.statusText)},t.onerror=function(){s(t.statusText)},t.send()}))},this.setRemote=function(e){var o="https://jsonblob.com/api/jsonBlob/"+s.key;return new Promise((function(s,t){var i=new XMLHttpRequest;i.open("PUT",o,!0),i.setRequestHeader("Content-type","application/json; charset=utf-8"),i.onload=function(){if(this.status>=200&&this.status<300)try{s("OK")}catch(e){t("KO")}else t("KO")},i.onerror=function(){t("KO")},i.send(JSON.stringify(e))}))},this.key="887426144165707776"}return Object(v.a)(e,[{key:"setLocal",value:function(e){if("undefined"!==typeof Storage)try{localStorage.setItem("games",JSON.stringify(e))}catch(o){}}},{key:"initLocal",value:function(){return new Promise((function(e,o){if("undefined"===typeof Storage)o("localStorage not supported");else if(null!==localStorage.getItem("games")){var s=localStorage.getItem("games");try{e(JSON.parse(s))}catch(t){o(t)}}}))}}]),e}(),F=function(e,o,s){var t="",i="",n=0,a="";return[1,2,3,4,5,6,7,8].forEach((function(o){t+=i,i="/",n=0,s.forEach((function(s,i){null===(a=e[8*(o-1)+i].fig)?n++:(n>0&&(t+=n+"",n=0),"B"===a.charAt(1)?t+=a.charAt(0).toLowerCase():t+=a.charAt(0).toUpperCase())})),n>0&&(t+=n+"",n=0)})),t+=" "+o.moveSide+" - - 0 "+o.number},E=function(e){Object(d.a)(s,e);var o=Object(p.a)(s);function s(e){var t;return Object(u.a)(this,s),(t=o.call(this)).reverseBoard=function(e){var o=!t.state.doReverseBoard;t.setState((function(e,s){return{doReverseBoard:o}}))},t.deleteGame=function(e){var o=Number(e.currentTarget.getAttribute("data-index"));t.doDeleteGame(o)},t.loadGame=function(e){var o=Number(e.currentTarget.getAttribute("data-index"));t.doLoadGame(o)},t.doDeleteGame=function(e){var o=Object(g.a)(t);if(t.state.isRemote&&t.state.storageManager){var s=t.state.games.filter((function(o){return o.id!==e})),i={games:s};o.state.storageManager.setRemote(s).then((function(e){if("OK"===e){o.state.storageManager.setLocal(s);var t=s&&s.length>0?o.gameStatus.showList:o.gameStatus.showInput;o.setGameStatus(t,"",i)}})).catch((function(e){}))}},t.doLoadGame=function(e){var o=t.state.games.filter((function(o){return o.id===e}));if(1===o.length){var s=o[0],i={data:JSON.parse(t.state.initialData),pgnResume:s.pgnResume,pgnHistory:s.pgnHistory,pgnGame:s.pgnGame,fenGame:s.fenGame,move:{number:0,side:"w"},scores:{whiteScore:0,blackScore:0,whiteJail:[],blackJail:[]}};t.setGameStatus(t.gameStatus.showMoves,"",i)}},t.moveGameTo=function(e){var o=10;"pace"in e&&"quick"===e.pace&&(o=1);var s=t.state.move,i=t.state.pgnGame,n=t.state.data,a=t.state.columns.slice(0),r=function(e,o,s,t){var i=k(s),n=k(o),a={moveSide:"",moveColumn:"",moveRow:0,movePieceType:null,moveType:null,isCheck:!1,isMat:!1,isError:!1,isDone:!0,possiblePositions:[],additionalMove:null,comingFromRow:0,comingFromColumn:"",uniqueFigure:!1,promoteTo:null,number:0};if(i>n){a.isDone=!1;var r={};(0===n?n=1:n+1)%2===1?(r.number=Math.trunc(n/2)+1,r.side="w"):(r.number=(n+1)/2,r.side="b");var m=e[r.number-1][r.side];if(a.moveSide=r.side,a.number=r.number,m=m.replace(/\?|!/,""),a.moveType="move",-1!==m.indexOf("x")&&(m=m.replace("x",""),a.moveType="take"),"+"===m.charAt(m.length-1)&&"+"===m.charAt(m.length-2)?(a.isMat=!0,m=m.substring(0,m.length-2)):"+"===m.charAt(m.length-1)&&(a.isCheck=!0,m=m.substring(0,m.length-1)),2===m.length)a.movePieceType="p",a.moveColumn=m.charAt(0),a.moveRow=parseInt(m.charAt(1)),isNaN(a.moveRow)&&(a.isError=!0);else if(3===m.length)"0-0"===m||"O-O"===m?(a.movePieceType="K",a.moveColumn="g",a.moveRow="w"===a.moveSide?1:8,a.moveType="castle-king",a.possiblePositions=[],a.additionalMove={moveSide:a.moveSide,moveColumn:"f",moveRow:a.moveRow,movePieceType:"R",moveType:a.moveType,isCheck:!1,isError:!1,possiblePositions:[]}):(x(m.charAt(0))?(a.movePieceType="p",a.comingFromColumn=m.charAt(0),a.moveColumn=m.charAt(1),a.moveRow=parseInt(m.charAt(2))):(a.movePieceType=m.charAt(0),a.moveColumn=m.charAt(1),a.moveRow=parseInt(m.charAt(2))),isNaN(a.moveRow)&&(a.isError=!0));else if(4===m.length)if("="===m.charAt(2))a.promoteTo=m.charAt(3),a.movePieceType="p",a.moveColumn=m.charAt(0),a.moveRow=parseInt(m.charAt(1));else{a.movePieceType=m.charAt(0);var c=m.charAt(1);isNaN(parseInt(c))?a.comingFromColumn=c:a.comingFromRow=parseInt(c),a.moveColumn=m.charAt(2),a.moveRow=parseInt(m.charAt(3)),isNaN(a.moveRow)&&(a.isError=!0)}else"0-0-0"===m||"O-O-O"===m?(a.movePieceType="K",a.moveColumn="c",a.moveRow="w"===a.moveSide?1:8,a.moveType="castle-queen",a.possiblePositions=[],a.additionalMove={moveSide:a.moveSide,moveColumn:"d",moveRow:a.moveRow,movePieceType:"R",moveType:a.moveType,isCheck:!1,isError:!1,possiblePositions:[]}):a.isError=!0;a.isError||(a.possiblePositions=[],"p"===a.movePieceType?N(a,t):"N"===a.movePieceType?M(a,t):"B"===a.movePieceType?T(a,t):"R"===a.movePieceType?S(a,t):"K"===a.movePieceType?y(a,t):"Q"===a.movePieceType&&(a.uniqueFigure=!0))}return a}(i,s,e,a);if(!r.isError&&!r.isDone){var m=!1;if(r.possiblePositions&&r.possiblePositions.length>0){for(var c=0;c<r.possiblePositions.length&&!m;c++)for(var l=0;l<n.length;l++)if(n[l].column===r.possiblePositions[c].column&&n[l].row===r.possiblePositions[c].row&&n[l].fig===r.movePieceType+r.moveSide.toUpperCase()){m=!0,n[l].fig=null;break}if(null!==r.additionalMove){for(var u=m,v=!1,d=0;d<n.length;d++)n[d].column===r.additionalMove.possiblePositions[0].column&&n[d].row===r.additionalMove.possiblePositions[0].row&&n[d].fig===r.additionalMove.movePieceType+r.additionalMove.moveSide.toUpperCase()&&(v=!0,n[d].fig=null);m=u&&v}}if(!0===r.uniqueFigure)for(var p=0;p<n.length;p++)if(n[p].fig===r.movePieceType+r.moveSide.toUpperCase()){m=!0,n[p].fig=null;break}if(m){for(var h=0;h<n.length;h++)if(n[h].column===r.moveColumn&&n[h].row===r.moveRow){if("take"===r.moveType){if(null===n[h].fig&&"p"===r.movePieceType){var f="w"===r.moveSide?8:-8;n[h+f].fig=null}n[h].fig=r.movePieceType+r.moveSide.toUpperCase()}else n[h].fig=r.promoteTo?r.promoteTo+r.moveSide.toUpperCase():r.movePieceType+r.moveSide.toUpperCase();break}if(null!=r.additionalMove)for(var b=0;b<n.length;b++)if(n[b].column===r.additionalMove.moveColumn&&n[b].row===r.additionalMove.moveRow){n[b].fig=r.additionalMove.movePieceType+r.additionalMove.moveSide.toUpperCase();break}var w=t.state.fenGame;if(0===w.filter((function(e){return e.number===r.number&&e.side===r.moveSide})).length){var A=t.state.data,j=t.state.columns.slice(0),P=F(A,r,j);P&&w.push({number:r.number,side:r.moveSide,fen:P})}t.setState((function(e,o){return{data:n,move:{number:r.number,side:r.moveSide},fenGame:w,status:t.gameStatus.showMoves}}));var O=Object(g.a)(t);setTimeout((function(){O.moveGameTo(e)}),o)}}},t.menuMove=function(e){var o=e.currentTarget.getAttribute("data-target");o in t.gameStatus&&t.setGameStatus(t.gameStatus[o])},t.movePGN=function(e){var o=function(e,o,s){var t=0,i="w",n=null,a=s[s.length-1];if("move"in e){var r=e.move;"first"===r?n={number:0,side:"w"}:"last"===r?(n="b"in a?{number:s.length,side:"b"}:{number:s.length,side:"w"}).pace="quick":"pause"===r?(n=o).pace="stop":"prev"===r?(o.number<=1&&"w"===o.side?n={number:0,side:"w"}:(n="b"===o.side?{number:o.number,side:"w"}:{number:o.number-1,side:"b"}).number<1&&(n={number:1,side:"w"}),n.pace="quick"):"next"===r&&(n=o.number===s.length?"b"===o.side?o:"b"in a?{number:s.length,side:"b"}:o:"b"===o.side?{number:o.number+1,side:"w"}:{number:o.number,side:"b"}).number<1&&(n={number:1,side:"w"})}else"turn"in e&&"side"in e&&(t=parseInt(e.turn),isNaN(t)&&(t=0),i=e.side);return t>0&&(n={number:t,side:i}),n}("move"in e?e:e.currentTarget.dataset,t.state.move,t.state.pgnGame),s=t.state.fenGame.filter((function(e){return e.number===o.number&&e.side===o.side}));if(0!==s.length){t.state.columns.slice(0);var i=JSON.parse(t.state.initialData),n=function(e){var o={whiteScore:0,blackScore:0,whiteJail:[],blackJail:[]},s=0,t=0,i=["p","R","B","N","Q"],n=[1,5,3,3,9],a={p:0,R:0,B:0,N:0,Q:0},r={p:0,R:0,B:0,N:0,Q:0},m={p:8,R:2,B:2,N:2,Q:1};for(var c in e.forEach((function(e,o){if(null!==e.fig){var m=e.fig.charAt(0),c=i.indexOf(m);-1!==c&&("W"===e.fig.charAt(1)?(a[m]+=1,s+=n[c]):(r[m]+=1,t+=n[c]))}})),o.whiteScore=s-t,o.blackScore=t-s,a)for(var l=m[c]-a[c],u=0;u<l;u++)o.blackJail.push(c);for(var v in r)for(var g=m[v]-r[v],d=0;d<g;d++)o.whiteJail.push(v);return o}(i=function(e,o,s){if(!e)return null;var t=e.split(" ")[0].split("/");if(8!==t.length)return null;var i=-1;return t.forEach((function(e,s){i=8*s;for(var t=e.length,n=0;n<t;n++){var a=e.charAt(n),r=parseInt(a);if(isNaN(r)){var m="W",c=a;x(a)?(m="B",c="p"===a?"p":a.toUpperCase()):c="P"===a?"p":a,o[i].fig=c+m,i++}else{for(var l=0;l<r;l++)o[i+l].fig=null;i+=r}}})),o}(s[0].fen,i));t.setState((function(e,s){return{data:i,scores:n,move:{number:o.number,side:o.side}}}))}},t.savePGN=function(){t.setGameStatus(t.gameStatus.showMessage,"Analyzing and saving your game");var e=document.getElementById("game-input");if(null!=e){var o=e.value;if(""!==o){var s=/\n\n/.exec(o).index,i=o.substring(0,s).replace(/\r\n?|\n/g,",").trim(),n=o.substring(s,o.length).replace(/\r\n?|\n/g," ").trim(),a=function(e){e=e.split(",");var o={};return e.forEach((function(e){var s=e.replace(/\\|\[|\]|"/g,""),t=s.indexOf(" ");if(-1!==t){var i=s.substring(0,t),n=s.substring(t+1,s.length);o[i]=n}})),o}(i);a.Site||(a.Site="???");var r=function(e){for(var o,s=[],t=1,i=e.indexOf(t+"."),n=0;-1!==i&&-1!==n;){o=-1!==(n=e.indexOf(t+1+"."))?n:i+100;var a=e.substring(i,o).replace(t+".","").trim().split(" "),r={w:a[0]};2===a.length&&(r.b=a[1]),s.push(r),i=n,t++}return s}(n),m=[{number:0,side:"w",fen:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"}],c=JSON.parse(t.state.initialData),l=t.state.columns.slice(0);r.forEach((function(e,o){["w","b"].forEach((function(s){if(s in e){var t=function(e,o,s,t,i){var n={moveSide:o,moveColumn:"",moveRow:0,movePieceType:null,moveType:null,isCheck:!1,isMat:!1,isError:!1,isDone:!0,possiblePositions:[],additionalMove:null,comingFromRow:0,comingFromColumn:"",uniqueFigure:!1,promoteTo:null,number:s};n.isDone=!1;var a="w"===o?e.w:e.b;if(a=a.replace(/\?|!/,""),n.moveType="move",-1!==a.indexOf("x")&&(a=a.replace("x",""),n.moveType="take"),"+"===a.charAt(a.length-1)&&"+"===a.charAt(a.length-2)?(n.isMat=!0,a=a.substring(0,a.length-2)):"+"===a.charAt(a.length-1)&&(n.isCheck=!0,a=a.substring(0,a.length-1)),2===a.length)n.movePieceType="p",n.moveColumn=a.charAt(0),n.moveRow=parseInt(a.charAt(1)),isNaN(n.moveRow)&&(n.isError=!0);else if(3===a.length)"0-0"===a||"O-O"===a?(n.movePieceType="K",n.moveColumn="g",n.moveRow="w"===n.moveSide?1:8,n.moveType="castle-king",n.possiblePositions=[],n.additionalMove={moveSide:n.moveSide,moveColumn:"f",moveRow:n.moveRow,movePieceType:"R",moveType:n.moveType,isCheck:!1,isError:!1,possiblePositions:[]}):(x(a.charAt(0))?(n.movePieceType="p",n.comingFromColumn=a.charAt(0),n.moveColumn=a.charAt(1),n.moveRow=parseInt(a.charAt(2))):(n.movePieceType=a.charAt(0),n.moveColumn=a.charAt(1),n.moveRow=parseInt(a.charAt(2))),isNaN(n.moveRow)&&(n.isError=!0));else if(4===a.length)if("="===a.charAt(2))n.promoteTo=a.charAt(3),n.movePieceType="p",n.moveColumn=a.charAt(0),n.moveRow=parseInt(a.charAt(1));else{n.movePieceType=a.charAt(0);var r=a.charAt(1);isNaN(parseInt(r))?n.comingFromColumn=r:n.comingFromRow=parseInt(r),n.moveColumn=a.charAt(2),n.moveRow=parseInt(a.charAt(3)),isNaN(n.moveRow)&&(n.isError=!0)}else"0-0-0"===a||"O-O-O"===a?(n.movePieceType="K",n.moveColumn="c",n.moveRow="w"===n.moveSide?1:8,n.moveType="castle-queen",n.possiblePositions=[],n.additionalMove={moveSide:n.moveSide,moveColumn:"d",moveRow:n.moveRow,movePieceType:"R",moveType:n.moveType,isCheck:!1,isError:!1,possiblePositions:[]}):n.isError=!0;return n.isError||(n.possiblePositions=[],"p"===n.movePieceType?N(n,i):"N"===n.movePieceType?M(n,i):"B"===n.movePieceType?T(n,i):"R"===n.movePieceType?S(n,i):"K"===n.movePieceType?y(n,i):"Q"===n.movePieceType&&(n.uniqueFigure=!0)),n}(e,s,o+1,0,l);c=function(e,o){if(!e.isError&&!e.isDone){var s=!1;if(e.possiblePositions&&e.possiblePositions.length>0){for(var t=0;t<e.possiblePositions.length&&!s;t++)for(var i=0;i<o.length;i++)if(o[i].column===e.possiblePositions[t].column&&o[i].row===e.possiblePositions[t].row&&o[i].fig===e.movePieceType+e.moveSide.toUpperCase()){s=!0,o[i].fig=null;break}if(null!==e.additionalMove){for(var n=s,a=!1,r=0;r<o.length;r++)o[r].column===e.additionalMove.possiblePositions[0].column&&o[r].row===e.additionalMove.possiblePositions[0].row&&o[r].fig===e.additionalMove.movePieceType+e.additionalMove.moveSide.toUpperCase()&&(a=!0,o[r].fig=null);s=n&&a}}if(!0===e.uniqueFigure)for(var m=0;m<o.length;m++)if(o[m].fig===e.movePieceType+e.moveSide.toUpperCase()){s=!0,o[m].fig=null;break}if(s){for(var c=0;c<o.length;c++)if(o[c].column===e.moveColumn&&o[c].row===e.moveRow){"take"===e.moveType?(null===o[c].fig&&"p"===e.movePieceType&&(o[c+("w"===e.moveSide?8:-8)].fig=null),o[c].fig=e.movePieceType+e.moveSide.toUpperCase()):o[c].fig=e.promoteTo?e.promoteTo+e.moveSide.toUpperCase():e.movePieceType+e.moveSide.toUpperCase();break}if(null!=e.additionalMove)for(var l=0;l<o.length;l++)if(o[l].column===e.additionalMove.moveColumn&&o[l].row===e.additionalMove.moveRow){o[l].fig=e.additionalMove.movePieceType+e.additionalMove.moveSide.toUpperCase();break}}}return o}(t,c);var i=F(c,t,l);i&&m.push({number:t.number,side:t.moveSide,fen:i})}}))}));var u={pgnHistory:o,pgnResume:a,pgnGame:r,fenGame:m};t.saveGameToStorage(u);var v={data:JSON.parse(t.state.initialData),pgnResume:a,pgnHistory:o,pgnGame:r,fenGame:m,move:{number:0,side:"w"},scores:{whiteScore:0,blackScore:0,whiteJail:[],blackJail:[]}};t.setGameStatus(t.gameStatus.showList,"",v)}else t.setGameStatus(t.gameStatus.inError,"unable to read this png")}},t.saveGameToStorage=function(e){var o=Object(g.a)(t);"id"in e||(e.id=(new Date).getTime()),t.setGameStatus(t.gameStatus.showMessage,"Saving analyzed game");var s=t.state.games;0===s.length?s.push(e):0===s.filter((function(o){return o.id===e.id})).length?s.push(e):s.forEach((function(o){o.pgnGame===e.pgnGame&&(o.pgnHistory=e.pgnHistory,o.pgnResume=e.pgnResume,o.fenGame=e.fenGame)}));t.state.isRemote&&t.state.storageManager&&o.state.storageManager.setRemote(s).then((function(e){"OK"===e&&o.state.storageManager.setLocal(s)})).catch((function(e){}))},t.setGameStatus=function(e,o,s){var i="";switch(e){case t.gameStatus.showInput:i={title:"Please enter a game in PGN format",message:""};break;case t.gameStatus.init:i={title:"New game saved",message:"analysing PGN game..."};break;case t.gameStatus.showMoves:i={title:"Game's moves",message:""};break;case t.gameStatus.showList:i={title:"Choose from list",message:""};break;case t.gameStatus.showMessage:i={title:"Current status",message:o};break;case t.gameStatus.inError:i={title:"Error !",message:o};break;default:i={title:"Error !",message:"the program is in error..."}}var n={status:e,infosTitle:i.title,infosMessage:i.message};if(s)for(var a in s)n[a]=s[a];t.setState((function(e,o){return n}))},t.initData=function(){var e=Object(g.a)(t),o=!0,s=!1,i=new G;i.initRemote().then((function(t){i.setLocal(t),e.initGames(t,o,s,i)})).catch((function(t){o=!1,i.initLocal().then((function(t){e.initGames(t,o,s,i)})).catch((function(t){s=!0,e.initGames(null,o,s,i)}))}))},t.initGames=function(e,o,s,i){if(s){var n=t.gameStatus.inError;t.props.setParentInfos({storageType:"no data"});var a={isRemote:o,initError:s,storageManager:i};t.setGameStatus(n,"",a)}else{var r=o?"online":"disconnected";t.props.setParentInfos({storageType:r});var m=t.gameStatus.showInput;e.length>0&&(m=t.gameStatus.showList);for(var c,l=t.state.pgnHistory,u=[],v=[],g=t.state.blackColor,d=t.state.whiteColor,p=t.state.black,h=t.state.white,f=d,b=0,w=0,A=0,j=7;j>=0;j--){b=t.state.rows[j];for(var P=0;P<8;P++)w=t.state.columns[P],++A%8===1?c=f:f=c=f===g?d:g,u.push({row:b,column:w,squareColor:c,fig:null})}t.state.figures.forEach((function(e,o){v.push({row:t.state.rows[0],column:t.state.columns[o],fig:e+h}),v.push({row:t.state.rows[1],column:t.state.columns[o],fig:t.state.pawn+h}),v.push({row:t.state.rows[6],column:t.state.columns[o],fig:t.state.pawn+p}),v.push({row:t.state.rows[7],column:t.state.columns[o],fig:e+p})})),u.forEach((function(e){var o=v.filter((function(o){return o.row===e.row&&o.column===e.column}));1===o.length&&(e.fig=o[0].fig)}));var O={storageManager:i,games:e,data:u,isRemote:o,initError:s,initialData:JSON.stringify(u),positions:v,move:{number:0,side:"w"},pgnHistory:l,scores:{whiteScore:0,blackScore:0,whiteJail:[],blackJail:[]}};t.setGameStatus(m,"",O)}},t.gameStatus={init:0,showList:1,showInput:2,showMoves:3,showMessage:4,inError:-1},t.state={storageManager:null,isRemote:!0,initError:!1,games:[],scores:{whiteScore:0,blackScore:0,whiteJail:[],blackJail:[]},gameKey:0,doReverseBoard:!1,proposeSave:!1,status:t.gameStatus.init,readerStop:!1,initialData:null,gameIsReady:!1,infosTitle:"",infosMessage:"",msg:"White to play",data:[],pgnHistory:"",move:{number:0,side:"b"},pgnResume:[],pgnGame:[],fenGame:[{number:0,side:"w",fen:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"}],positions:[],columns:"a,b,c,d,e,f,g,h".split(","),rows:[1,2,3,4,5,6,7,8],figures:"R,N,B,Q,K,B,N,R".split(","),pawn:"p",black:"B",white:"W",blackColor:"dark-square",whiteColor:"light-square",nrSquaresPerside:8,figCodes:{KB:"&#9818;",QB:"&#9819;",RB:"&#9820;",BB:"&#9821;",NB:"&#9822;",pB:"&#9823;",KW:"&#9812;",QW:"&#9813;",RW:"&#9814;",BW:"&#9815;",NW:"&#9816;",pW:"&#9817;"}},t}return Object(v.a)(s,[{key:"componentDidMount",value:function(){this.initData()}},{key:"render",value:function(){return this.state.status===this.gameStatus.showInput?this.state.isRemote?Object(c.jsxs)("div",{className:"game",children:[Object(c.jsx)("div",{className:"game-board",children:Object(c.jsx)(w,{reverseBoard:this.reverseBoard,game:this.state},1)}),Object(c.jsx)("div",{className:"game-info",children:Object(c.jsx)(C,{game:this.state,movePGN:this.movePGN,menuMove:this.menuMove,savePGN:this.savePGN,statuses:this.gameStatus},1)})]}):Object(c.jsx)("div",{className:"game",children:Object(c.jsxs)("div",{children:[Object(c.jsx)("h1",{children:'"Offline Mode"'}),Object(c.jsx)("p",{children:"You can't add games in offline mode, sorry :-( "})]})}):this.state.status===this.gameStatus.showList?Object(c.jsxs)("div",{className:"game",children:[Object(c.jsx)("div",{className:"game-board",children:Object(c.jsx)(w,{reverseBoard:this.reverseBoard,game:this.state},1)}),Object(c.jsx)("div",{className:"game-info",children:Object(c.jsx)(C,{game:this.state,loadGame:this.loadGame,deleteGame:this.deleteGame,menuMove:this.menuMove,statuses:this.gameStatus},1)})]}):this.state.status===this.gameStatus.showMoves?Object(c.jsxs)("div",{className:"game",children:[Object(c.jsx)("div",{className:"game-board",children:Object(c.jsx)(w,{reverseBoard:this.reverseBoard,game:this.state},1)}),Object(c.jsx)("div",{className:"game-info",children:Object(c.jsx)(C,{game:this.state,movePGN:this.movePGN,menuMove:this.menuMove,savePGN:this.savePGN,statuses:this.gameStatus},1)})]}):this.state.status===this.gameStatus.showMessage?Object(c.jsx)("div",{className:"game",children:Object(c.jsxs)("div",{children:[Object(c.jsxs)("h1",{children:[" ",this.state.infosTitle," "]}),Object(c.jsxs)("p",{children:[" ",this.state.infosMessage," "]})]})}):Object(c.jsx)("div",{className:"game",children:Object(c.jsx)("h1",{children:" Loading "})})}}]),s}(i.a.Component);var B=function(){var e=Object(t.useState)({storageType:"no data"}),o=Object(r.a)(e,2),s=o[0],i=o[1];return Object(c.jsxs)("div",{className:"App",children:[Object(c.jsx)(l,{parentInfos:s}),Object(c.jsx)(E,{parentInfos:s,setParentInfos:i})]})};a.a.render(Object(c.jsx)(B,{}),document.getElementById("root"))}],[[27,1,2]]]);
//# sourceMappingURL=main.dde8094f.chunk.js.map