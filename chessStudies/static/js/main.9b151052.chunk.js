(this.webpackJsonpnpm=this.webpackJsonpnpm||[]).push([[0],[,,,,,,,,,,,,,function(e,o,s){},function(e,o,s){},function(e,o,s){},,function(e,o,s){},function(e,o,s){},function(e,o,s){},function(e,o,s){},function(e,o,s){},function(e,o,s){},function(e,o,s){},function(e,o,s){},function(e,o,s){},function(e,o,s){"use strict";s.r(o);var i=s(1),t=s.n(i),a=s(4),n=s.n(a),r=(s(13),s(14),s(15),s.p+"static/media/zadigChess.ba50ba27.png"),m=s(0),c=function(){return Object(m.jsxs)("div",{className:"header",children:[Object(m.jsx)("img",{src:r,className:"logo",alt:"logo"}),Object(m.jsx)("div",{className:"title",children:"Chess Studies"})]})},l=s(5),u=s(6),v=s(2),g=s(8),d=s(7);s(17),s(18),s(19);function p(e){return 0===e?"":e>0?"+"+e:""+e}function h(e,o,s,i){var t="w"===i?"B":"W",a="",n="w"===i?o:e,r=n&&n.length>1?n[0]:"";return n.forEach((function(e){r!==e&&(a+="&nbsp;&nbsp;",r=e),a+=s[e+t]})),{__html:a}}var b=function(e){var o=e.scores.whiteJail,s=e.scores.blackJail,i=e.figCodes,t=e.side;return Object(m.jsxs)("div",{className:"jail ".concat("inversed"===e.boardPosition?"reverse":""," \n        ").concat("b"===e.side?"inversed"===e.boardPosition?"black":"white":"inversed"===e.boardPosition?"white":"black"),children:[Object(m.jsxs)("span",{className:"jail-yard",children:[Object(m.jsx)("span",{className:"player",children:"b"===e.side?e.pgnResume.Black:e.pgnResume.White}),Object(m.jsx)("span",{className:"score",children:"b"===e.side?p(e.scores.whiteScore):p(e.scores.blackScore)}),Object(m.jsx)("span",{className:"list",dangerouslySetInnerHTML:h(o,s,i,t)})]}),Object(m.jsx)("span",{className:"inverse-clickable",onClick:e.reverseBoard,dangerouslySetInnerHTML:{__html:"\u21f5"}})]})},f=function(e){return Object(m.jsxs)("div",{className:"board-zone ".concat(e.game.doReverseBoard?"inverse":""),children:[Object(m.jsx)(b,{side:"w",reverseBoard:e.reverseBoard,figCodes:e.game.figCodes,pgnResume:e.game.pgnResume,scores:e.game.scores}),Object(m.jsx)("div",{className:"board",children:e.game.data.map((function(o,s){return Object(m.jsx)(t.a.Fragment,{children:Object(m.jsx)("div",{"data-pos":s,className:"square "+o.squareColor,dangerouslySetInnerHTML:{__html:e.game.figCodes[o.fig]?e.game.figCodes[o.fig]:"&nbsp;"}},s)},s)}))}),Object(m.jsx)(b,{side:"b",reverseBoard:e.reverseBoard,figCodes:e.game.figCodes,pgnResume:e.game.pgnResume,scores:e.game.scores})]})},w=(s(20),s(21),function(e){return Object(m.jsx)("div",{className:"game-turns",children:Object(m.jsx)("ol",{children:e.turnsList.map((function(o,s){return Object(m.jsxs)("li",{children:[Object(m.jsx)("span",{onClick:e.movePGN,"data-turn":s+1,"data-side":"w",className:"turn-w ".concat(e.currentMove.number===s+1&&"w"===e.currentMove.side?"turn-current":""),children:o.w}),Object(m.jsx)("span",{onClick:e.movePGN,"data-turn":s+1,"data-side":"b",className:"turn-b ".concat(e.currentMove.number===s+1&&"b"===e.currentMove.side?"turn-current":""),children:o.b})]},s)}))})})}),A=(s(22),function(e){return Object(m.jsxs)("div",{className:"game-resume",children:[e.resume.Date," ",e.resume.White," vs ",e.resume.Black," ",e.resume.Result]})}),j=(s(23),function(e){return Object(m.jsxs)("div",{className:"moves-board",children:[Object(m.jsx)("span",{"data-move":"first",onClick:e.movePGN,children:Object(m.jsx)("img",{src:"data:image/gif;base64,R0lGODlhMQAnAMwAAAAAALKAP3+vxWaaxZnFxQAAPwAAZsW2kr+mecW8n18rAGw7E0YTAIxULDM1M5KTkplkLF8rP39CE2aarMW2pZnFv6W2xXKdxb+mpbKKWYxUU0YTZr+vn2w7ZsXFxQAAACH5BAEAAB4ALAAAAAAxACcAAAX/oCeOZGmeaKqubOu+cCzPdG1njnO1mEvBAQBgwEJsCKxDRPAKDlcIhgGpOigKTJeTmIoCplUFANsUck/eL/VkFZK1ZlRajWq7s60tmiEUgk12d2VPJXN+ayOBgnCEI4aHJYqLeXGOfH19fyKSkyx6Io+Za5ydK5+hoptimJhvlE+oqaR9rp5msaKztHi2ABMSrMFfFRDCrLWmZgkLxqkNzaUqesvQf8/NyNKV1Maa18LZKZ8e3MGaHt/HvMmN5MzmiOjg69rt7vAm6dHilSTlkPnUDTrj7x3AgLsGoih3rsS3cCjGmeDW0OG+iP1OUKtoEeIJiRoXcHTo0QRIjR3iF6HQQC8FhwcPLNiYSbOmzZs4c+rcGSMEADs=",className:"command-img",alt:"first"})}),Object(m.jsx)("span",{"data-move":"prev",onClick:e.movePGN,children:Object(m.jsx)("img",{src:"data:image/gif;base64,R0lGODlhIAAnALsAAAAAAH+vxQAAP7mXZqyDTCwAABkAAIavxYyvxbmXf6yDbBkAPywAP8XFxQAAAAAAACH5BAEAAA0ALAAAAAAgACcAAARzsMlJq7046827/2AoZsoxasQSnBhhCCtbuQAsU3Qd37l+Nz2fLCg8EYuiIxKkXHqaTg40ijIArtgsNTMoaL+2UPebDYu95O1mTDaL2Fr3G13eneBX+Qiv39P7fnl2N2OAdwWGdwyDPw0JCI2RkpOUlZYWEQA7",className:"command-img",alt:"prev"})}),Object(m.jsx)("span",{"data-move":"pause",className:"hidden",onClick:e.movePGN,children:"\u23f8"}),Object(m.jsx)("span",{"data-move":"next",onClick:e.movePGN,children:Object(m.jsx)("img",{src:"data:image/gif;base64,R0lGODlhJQAnALsAAAAAAMWvfz8AAGaXuUaArAAALAAAE3+XuT8AE8WvjGaArD8ALMWvhsXFxQAAAAAAACH5BAEAAA0ALAAAAAAlACcAAAR2sMlJq7046827/2AojhijkF+AEGgXCAbbai8Qz1lty3il7z2fAEAEBiU/4u2YVPJwTWcwKoUOi1hji1pcorjdpwhMLAy212zRPAOz2+nsG64GzOny8zRu1++xdz0/gYJXhIV9R0KHUwt+ihMJB5CUlZaXmJkkEQA7",className:"command-img",alt:"next"})}),Object(m.jsx)("span",{"data-move":"last",onClick:e.movePGN,children:Object(m.jsx)("img",{src:"data:image/gif;base64,R0lGODlhLwAnAMwAAAAAAGaaxcWvf8WaZrKAPz8AAJ+8xRM7bDlun5K2xQAAEwArXyxUjDM1M5KTkqW2xaWAP3KdxT99rL+vnyxkmVNUjD8rX7KKWcWpn8XFxQAAAAAAAAAAAAAAAAAAAAAAACH5BAEAABkALAAAAAAvACcAAAX/YCaOZGmeaKqubOu+cCzPdK1ihvu0V9NErcEhtxJYEiwCABAIAobFwgKpUjKdTyJKUABMq8sma7DMprjLL8oqXpHL0BM6TTWxsXAtaU4/3cdleSZ8fSV/boGCe12JaiOHKm+JZiOEZY4ZkCmSk3EZlpd1miicnUSgoSKjJ6Wmn4yTfasmraaogVOzJbWJChK3gRQQYXixAAoIr8ZlDJnEgMvIIsAAzc5X0LHS07CT1tdtkcbb3Mbf4MVl5OXehs+IvckloOeq7+KB65Xd1X73m/nkDepW79E/UuoEDmSWQheJN/rmMSpIwuEIMhEl9gODzU1GiRTddYyk8EyFFhZtEqiY4MDBDpUwY8qcSbOmzZohAAA7",className:"command-img",alt:"last"})})]})}),P=(s(24),function(e){return Object(m.jsx)("div",{className:"game-list",children:Object(m.jsx)("ol",{children:e.games.map((function(o,s){return Object(m.jsx)("li",{children:Object(m.jsxs)("div",{className:"list-element",children:[Object(m.jsxs)("span",{className:"list-element-text",children:[o.pgnResume.Event," ",o.pgnResume.Site," ",o.pgnResume.Date," ",Object(m.jsx)("br",{}),o.pgnResume.White," (",o.pgnResume.WhiteElo,") ","vs"," ",o.pgnResume.Black," (",o.pgnResume.BlackElo,")  ","=>"," ",o.pgnResume.Result]}),Object(m.jsx)("span",{className:"button choose","data-index":s,onClick:e.loadGame}),Object(m.jsx)("span",{className:"button delete","data-index":s,onClick:e.deleteGame})]})},s)}))})})}),C=(s(25),function(e){return Object(m.jsxs)("div",{className:"game-menu",children:[Object(m.jsx)("div",{"data-target":"showMoves",className:"".concat(e.movesLoaded?"":"hidden"),onClick:e.menuMove,children:"Moves"}),Object(m.jsx)("div",{"data-target":"showList",onClick:e.menuMove,children:"Games list"}),Object(m.jsx)("div",{"data-target":"showInput",onClick:e.menuMove,children:"New game"})]})}),O=function(e){var o=e.game.status,s=(e.game.pgnHistory,e.statuses);return o===s.showInput?Object(m.jsxs)(t.a.Fragment,{children:[Object(m.jsx)(C,{menuMove:e.menuMove,movesLoaded:e.game.pgnHistory&&e.game.pgnHistory>1}),Object(m.jsxs)("div",{className:"info-zone",children:[Object(m.jsx)("h3",{className:"board-title",children:e.game.infosTitle}),Object(m.jsx)("textarea",{id:"game-input",className:"game-input",name:"pgn"}),Object(m.jsx)("button",{onClick:e.savePGN,children:"Go"})]})]}):o===s.showList?Object(m.jsxs)(t.a.Fragment,{children:[Object(m.jsx)(C,{menuMove:e.menuMove,movesLoaded:!!(e.game.pgnHistory&&e.game.pgnHistory.length>1)}),Object(m.jsxs)("div",{className:"list-zone",children:[Object(m.jsx)("h3",{className:"board-list-title",children:e.game.infosTitle}),Object(m.jsx)(P,{games:e.game.games,deleteGame:e.deleteGame,loadGame:e.loadGame})]})]}):o===s.showMessage||o===s.inError||o===s.init?Object(m.jsxs)("div",{className:"info-zone",children:[Object(m.jsx)("h3",{className:"board-title",children:e.game.infosTitle}),Object(m.jsx)("p",{className:"infosMessage",children:e.game.infosMessage})]}):o===s.showMoves?Object(m.jsxs)(t.a.Fragment,{children:[Object(m.jsx)(C,{menuMove:e.menuMove,movesLoaded:e.game.pgnHistory&&e.game.pgnHistory>1}),Object(m.jsxs)("div",{className:"turns-zone",children:[Object(m.jsx)(A,{resume:e.game.pgnResume}),Object(m.jsx)(w,{turnsList:e.game.pgnGame,currentMove:e.game.move,movePGN:e.movePGN}),Object(m.jsx)(j,{movePGN:e.movePGN})]})]}):Object(m.jsxs)("div",{className:"info-zone",children:[Object(m.jsx)("h3",{className:"board-title",children:"404"}),Object(m.jsx)("p",{className:"infosMessage",children:"Sorry Buddy, I'm afraid we are lost !"})]})},R=function(e){return e!==e.toUpperCase()},S=function(e,o){for(var s=1;s<9;s++)if(s!==e.moveRow){var i={column:e.moveColumn,row:s};0!==e.comingFromRow&&i.row!==e.comingFromRow||""!==e.comingFromColumn&&i.column!==e.comingFromColumn||e.possiblePositions.push(i)}for(var t=0;t<8;t++)if(o[t]!==e.moveColumn){var a={column:o[t],row:e.moveRow};0!==e.comingFromRow&&a.row!==e.comingFromRow||""!==e.comingFromColumn&&a.column!==e.comingFromColumn||e.possiblePositions.push(a)}},x=function(e,o){"castle-king"===e.moveType?(e.possiblePositions.push({column:"e",row:"w"===e.moveSide?1:8}),e.additionalMove.possiblePositions.push({column:"h",row:"w"===e.moveSide?1:8}),e.moveType="move",e.additionalMove.moveType="move"):"castle-queen"===e.moveType?(e.possiblePositions.push({column:"e",row:"w"===e.moveSide?1:8}),e.additionalMove.possiblePositions.push({column:"a",row:"w"===e.moveSide?1:8}),e.moveType="move",e.additionalMove.moveType="move"):e.uniqueFigure=!0},N=function(e,o){if(4===e.moveRow&&"w"===e.moveSide&&"move"===e.moveType)e.possiblePositions.push({column:e.moveColumn,row:3}),e.possiblePositions.push({column:e.moveColumn,row:2});else if(5===e.moveRow&&"b"===e.moveSide&&"move"===e.moveType)e.possiblePositions.push({column:e.moveColumn,row:7}),e.possiblePositions.push({column:e.moveColumn,row:6});else if("move"===e.moveType)e.possiblePositions.push({column:e.moveColumn,row:"w"===e.moveSide?e.moveRow-1:e.moveRow+1});else if("take"===e.moveType)if(""!==e.comingFromColumn)e.possiblePositions.push({column:e.comingFromColumn,row:"w"===e.moveSide?e.moveRow-1:e.moveRow+1});else{var s=o.indexOf(e.moveColumn);0===s?e.possiblePositions.push({column:o[1],row:"w"===e.moveSide?e.moveRow-1:e.moveRow+1}):7===s?e.possiblePositions.push({column:o[6],row:"w"===e.moveSide?e.moveRow-1:e.moveRow+1}):(e.possiblePositions.push({column:o[s-1],row:"w"===e.moveSide?e.moveRow-1:e.moveRow+1}),e.possiblePositions.push({column:o[s+1],row:"w"===e.moveSide?e.moveRow-1:e.moveRow+1}))}else e.isError=!0},y=function(e,o){for(var s=e.moveRow,i=o.indexOf(e.moveColumn)+1,t=i+1,a=s+1,n=0;n<9;n++){if(t<9&&a<9){var r={column:o[t-1],row:a};0!==e.comingFromRow&&r.row!==e.comingFromRow||""!==e.comingFromColumn&&r.column!==e.comingFromColumn||e.possiblePositions.push(r)}t++,a++}t=i-1,a=s+1;for(var m=0;m<9;m++){if(t>0&&a<9){var c={column:o[t-1],row:a};0!==e.comingFromRow&&c.row!==e.comingFromRow||""!==e.comingFromColumn&&c.column!==e.comingFromColumn||e.possiblePositions.push(c)}t--,a++}t=i+1,a=s-1;for(var l=0;l<9;l++){if(t<9&&a>0){var u={column:o[t-1],row:a};0!==e.comingFromRow&&u.row!==e.comingFromRow||""!==e.comingFromColumn&&u.column!==e.comingFromColumn||e.possiblePositions.push(u)}t++,a--}t=i-1,a=s-1;for(var v=8;v>0;v--){if(t>0&&t>0){var g={column:o[t-1],row:a};0!==e.comingFromRow&&g.row!==e.comingFromRow||""!==e.comingFromColumn&&g.column!==e.comingFromColumn||e.possiblePositions.push(g)}t--,a--}},T=function(e,o){var s=e.moveRow,i=o.indexOf(e.moveColumn)+1;if(s-2>0&&i-1>0){var t={column:o[i-1-1],row:s-2};0!==e.comingFromRow&&t.row!==e.comingFromRow||""!==e.comingFromColumn&&t.column!==e.comingFromColumn||e.possiblePositions.push(t)}if(s-2>0&&i+1<9){var a={column:o[i+1-1],row:s-2};0!==e.comingFromRow&&a.row!==e.comingFromRow||""!==e.comingFromColumn&&a.column!==e.comingFromColumn||e.possiblePositions.push(a)}if(s+2<9&&i-1>0){var n={column:o[i-1-1],row:s+2};0!==e.comingFromRow&&n.row!==e.comingFromRow||""!==e.comingFromColumn&&n.column!==e.comingFromColumn||e.possiblePositions.push(n)}if(s+2<9&&i+1<9){var r={column:o[i+1-1],row:s+2};0!==e.comingFromRow&&r.row!==e.comingFromRow||""!==e.comingFromColumn&&r.column!==e.comingFromColumn||e.possiblePositions.push(r)}if(s-1>0&&i-2>0){var m={column:o[i-2-1],row:s-1};0!==e.comingFromRow&&m.row!==e.comingFromRow||""!==e.comingFromColumn&&m.column!==e.comingFromColumn||e.possiblePositions.push(m)}if(s-1>0&&i+2<9){var c={column:o[i+2-1],row:s-1};0!==e.comingFromRow&&c.row!==e.comingFromRow||""!==e.comingFromColumn&&c.column!==e.comingFromColumn||e.possiblePositions.push(c)}if(s+1<9&&i-2>0){var l={column:o[i-2-1],row:s+1};0!==e.comingFromRow&&l.row!==e.comingFromRow||""!==e.comingFromColumn&&l.column!==e.comingFromColumn||e.possiblePositions.push(l)}if(s+1<9&&i+2<9){var u={column:o[i+2-1],row:s+1};0!==e.comingFromRow&&u.row!==e.comingFromRow||""!==e.comingFromColumn&&u.column!==e.comingFromColumn||e.possiblePositions.push(u)}},M=function(e){return 0===e.number?0:2*(e.number-1)+("w"===e.side?1:2)},k=function(e,o,s){var i="",t="",a=0,n="";return[1,2,3,4,5,6,7,8].forEach((function(o){i+=t,t="/",a=0,s.forEach((function(s,t){null===(n=e[8*(o-1)+t].fig)?a++:(a>0&&(i+=a+"",a=0),"B"===n.charAt(1)?i+=n.charAt(0).toLowerCase():i+=n.charAt(0).toUpperCase())})),a>0&&(i+=a+"",a=0)})),i+=" "+o.moveSide+" - - 0 "+o.number},G=function(e){Object(g.a)(s,e);var o=Object(d.a)(s);function s(){var e;return Object(l.a)(this,s),(e=o.call(this)).reverseBoard=function(o){var s=!e.state.doReverseBoard;e.setState((function(e,o){return{doReverseBoard:s}}))},e.deleteGame=function(o){var s=o.currentTarget.getAttribute("data-index");e.state.games&&e.state.games.length>0&&s<e.state.games.length&&e.doDeleteGame(s)},e.loadGame=function(o){var s=o.currentTarget.getAttribute("data-index");e.state.games&&e.state.games.length>0&&s<e.state.games.length&&e.doLoadGame(s)},e.doDeleteGame=function(o){var s=JSON.parse(JSON.stringify(e.state.games));s.splice(o,1);var i={games:s};localStorage.setItem("games",JSON.stringify(s));var t=s&&s.length>0?e.gameStatus.showList:e.gameStatus.showInput;e.setGameStatus(t,"",i)},e.doLoadGame=function(o){var s=e.state.games[o],i={data:JSON.parse(e.state.initialData),pgnResume:s.pgnResume,pgnHistory:s.pgnHistory,pgnGame:s.pgnGame,fenGame:s.fenGame,move:{number:0,side:"w"},scores:{whiteScore:0,blackScore:0,whiteJail:[],blackJail:[]}};e.setGameStatus(e.gameStatus.showMoves,"",i)},e.moveGameTo=function(o){var s=10;"pace"in o&&"quick"===o.pace&&(s=1);var i=e.state.move,t=e.state.pgnGame,a=e.state.data,n=e.state.columns.slice(0),r=function(e,o,s,i){var t=M(s),a=M(o),n={moveSide:"",moveColumn:"",moveRow:0,movePieceType:null,moveType:null,isCheck:!1,isMat:!1,isError:!1,isDone:!0,possiblePositions:[],additionalMove:null,comingFromRow:0,comingFromColumn:"",uniqueFigure:!1,promoteTo:null,number:0};if(t>a){n.isDone=!1;var r={};(0===a?a=1:a+1)%2===1?(r.number=Math.trunc(a/2)+1,r.side="w"):(r.number=(a+1)/2,r.side="b");var m=e[r.number-1][r.side];if(n.moveSide=r.side,n.number=r.number,m=m.replace(/\?|!/,""),n.moveType="move",-1!==m.indexOf("x")&&(m=m.replace("x",""),n.moveType="take"),"+"===m.charAt(m.length-1)&&"+"===m.charAt(m.length-2)?(n.isMat=!0,m=m.substring(0,m.length-2)):"+"===m.charAt(m.length-1)&&(n.isCheck=!0,m=m.substring(0,m.length-1)),2===m.length)n.movePieceType="p",n.moveColumn=m.charAt(0),n.moveRow=parseInt(m.charAt(1)),isNaN(n.moveRow)&&(n.isError=!0);else if(3===m.length)"0-0"===m||"O-O"===m?(n.movePieceType="K",n.moveColumn="g",n.moveRow="w"===n.moveSide?1:8,n.moveType="castle-king",n.possiblePositions=[],n.additionalMove={moveSide:n.moveSide,moveColumn:"f",moveRow:n.moveRow,movePieceType:"R",moveType:n.moveType,isCheck:!1,isError:!1,possiblePositions:[]}):(R(m.charAt(0))?(n.movePieceType="p",n.comingFromColumn=m.charAt(0),n.moveColumn=m.charAt(1),n.moveRow=parseInt(m.charAt(2))):(n.movePieceType=m.charAt(0),n.moveColumn=m.charAt(1),n.moveRow=parseInt(m.charAt(2))),isNaN(n.moveRow)&&(n.isError=!0));else if(4===m.length)if("="===m.charAt(2))n.promoteTo=m.charAt(3),n.movePieceType="p",n.moveColumn=m.charAt(0),n.moveRow=parseInt(m.charAt(1));else{n.movePieceType=m.charAt(0);var c=m.charAt(1);isNaN(parseInt(c))?n.comingFromColumn=c:n.comingFromRow=parseInt(c),n.moveColumn=m.charAt(2),n.moveRow=parseInt(m.charAt(3)),isNaN(n.moveRow)&&(n.isError=!0)}else"0-0-0"===m||"O-O-O"===m?(n.movePieceType="K",n.moveColumn="c",n.moveRow="w"===n.moveSide?1:8,n.moveType="castle-queen",n.possiblePositions=[],n.additionalMove={moveSide:n.moveSide,moveColumn:"d",moveRow:n.moveRow,movePieceType:"R",moveType:n.moveType,isCheck:!1,isError:!1,possiblePositions:[]}):n.isError=!0;n.isError||(n.possiblePositions=[],"p"===n.movePieceType?N(n,i):"N"===n.movePieceType?T(n,i):"B"===n.movePieceType?y(n,i):"R"===n.movePieceType?S(n,i):"K"===n.movePieceType?x(n,i):"Q"===n.movePieceType&&(n.uniqueFigure=!0))}return n}(t,i,o,n);if(!r.isError&&!r.isDone){var m=!1;if(r.possiblePositions&&r.possiblePositions.length>0){for(var c=0;c<r.possiblePositions.length&&!m;c++)for(var l=0;l<a.length;l++)if(a[l].column===r.possiblePositions[c].column&&a[l].row===r.possiblePositions[c].row&&a[l].fig===r.movePieceType+r.moveSide.toUpperCase()){m=!0,a[l].fig=null;break}if(null!==r.additionalMove){for(var u=m,g=!1,d=0;d<a.length;d++)a[d].column===r.additionalMove.possiblePositions[0].column&&a[d].row===r.additionalMove.possiblePositions[0].row&&a[d].fig===r.additionalMove.movePieceType+r.additionalMove.moveSide.toUpperCase()&&(g=!0,a[d].fig=null);m=u&&g}}if(!0===r.uniqueFigure)for(var p=0;p<a.length;p++)if(a[p].fig===r.movePieceType+r.moveSide.toUpperCase()){m=!0,a[p].fig=null;break}if(m){for(var h=0;h<a.length;h++)if(a[h].column===r.moveColumn&&a[h].row===r.moveRow){if("take"===r.moveType){if(null===a[h].fig&&"p"===r.movePieceType){var b="w"===r.moveSide?8:-8;a[h+b].fig=null}a[h].fig=r.movePieceType+r.moveSide.toUpperCase()}else a[h].fig=r.promoteTo?r.promoteTo+r.moveSide.toUpperCase():r.movePieceType+r.moveSide.toUpperCase();break}if(null!=r.additionalMove)for(var f=0;f<a.length;f++)if(a[f].column===r.additionalMove.moveColumn&&a[f].row===r.additionalMove.moveRow){a[f].fig=r.additionalMove.movePieceType+r.additionalMove.moveSide.toUpperCase();break}var w=e.state.fenGame;if(0===w.filter((function(e){return e.number===r.number&&e.side===r.moveSide})).length){var A=e.state.data,j=e.state.columns.slice(0),P=k(A,r,j);P&&w.push({number:r.number,side:r.moveSide,fen:P})}e.setState((function(o,s){return{data:a,move:{number:r.number,side:r.moveSide},fenGame:w,status:e.gameStatus.showMoves}}));var C=Object(v.a)(e);setTimeout((function(){C.moveGameTo(o)}),s)}}},e.menuMove=function(o){var s=o.currentTarget.getAttribute("data-target");s in e.gameStatus&&e.setGameStatus(e.gameStatus[s])},e.movePGN=function(o){var s=function(e,o,s){var i=0,t="w",a=null,n=s[s.length-1];if("move"in e){var r=e.move;"first"===r?a={number:0,side:"w"}:"last"===r?(a="b"in n?{number:s.length,side:"b"}:{number:s.length,side:"w"}).pace="quick":"pause"===r?(a=o).pace="stop":"prev"===r?(o.number<=1&&"w"===o.side?a={number:0,side:"w"}:(a="b"===o.side?{number:o.number,side:"w"}:{number:o.number-1,side:"b"}).number<1&&(a={number:1,side:"w"}),a.pace="quick"):"next"===r&&(a=o.number===s.length?"b"===o.side?o:"b"in n?{number:s.length,side:"b"}:o:"b"===o.side?{number:o.number+1,side:"w"}:{number:o.number,side:"b"}).number<1&&(a={number:1,side:"w"})}else"turn"in e&&"side"in e&&(i=parseInt(e.turn),isNaN(i)&&(i=0),t=e.side);return i>0&&(a={number:i,side:t}),a}("move"in o?o:o.currentTarget.dataset,e.state.move,e.state.pgnGame),i=e.state.fenGame.filter((function(e){return e.number===s.number&&e.side===s.side}));if(0!==i.length){e.state.columns.slice(0);var t=JSON.parse(e.state.initialData),a=function(e){var o={whiteScore:0,blackScore:0,whiteJail:[],blackJail:[]},s=0,i=0,t=["p","R","B","N","Q"],a=[1,5,3,3,9],n={p:0,R:0,B:0,N:0,Q:0},r={p:0,R:0,B:0,N:0,Q:0},m={p:8,R:2,B:2,N:2,Q:1};for(var c in e.forEach((function(e,o){if(null!==e.fig){var m=e.fig.charAt(0),c=t.indexOf(m);-1!==c&&("W"===e.fig.charAt(1)?(n[m]+=1,s+=a[c]):(r[m]+=1,i+=a[c]))}})),o.whiteScore=s-i,o.blackScore=i-s,n)for(var l=m[c]-n[c],u=0;u<l;u++)o.blackJail.push(c);for(var v in r)for(var g=m[v]-r[v],d=0;d<g;d++)o.whiteJail.push(v);return o}(t=function(e,o,s){if(!e)return null;var i=e.split(" ")[0].split("/");if(8!==i.length)return null;var t=-1;return i.forEach((function(e,s){t=8*s;for(var i=e.length,a=0;a<i;a++){var n=e.charAt(a),r=parseInt(n);if(isNaN(r)){var m="W",c=n;R(n)?(m="B",c="p"===n?"p":n.toUpperCase()):c="P"===n?"p":n,o[t].fig=c+m,t++}else{for(var l=0;l<r;l++)o[t+l].fig=null;t+=r}}})),o}(i[0].fen,t));e.setState((function(e,o){return{data:t,scores:a,move:{number:s.number,side:s.side}}}))}},e.savePGN=function(){e.setGameStatus(e.gameStatus.showMessage,"Aanalyzing and saving your game");var o=document.getElementById("game-input");if(null!=o){var s=o.value;if(""!==s){var i=/\n\n/.exec(s).index,t=s.substring(0,i).replace(/\r\n?|\n/g,",").trim(),a=s.substring(i,s.length).replace(/\r\n?|\n/g," ").trim(),n=function(e){e=e.split(",");var o={};return e.forEach((function(e){var s=e.replace(/\\|\[|\]|"/g,""),i=s.indexOf(" ");if(-1!==i){var t=s.substring(0,i),a=s.substring(i+1,s.length);o[t]=a}})),o}(t);n.Site||(n.Site="???");var r=function(e){for(var o,s=[],i=1,t=e.indexOf(i+"."),a=0;-1!==t&&-1!==a;){o=-1!==(a=e.indexOf(i+1+"."))?a:t+100;var n=e.substring(t,o).replace(i+".","").trim().split(" "),r={w:n[0]};2===n.length&&(r.b=n[1]),s.push(r),t=a,i++}return s}(a),m=[{number:0,side:"w",fen:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"}],c=JSON.parse(e.state.initialData),l=e.state.columns.slice(0);r.forEach((function(e,o){["w","b"].forEach((function(s){if(s in e){var i=function(e,o,s,i,t){var a={moveSide:o,moveColumn:"",moveRow:0,movePieceType:null,moveType:null,isCheck:!1,isMat:!1,isError:!1,isDone:!0,possiblePositions:[],additionalMove:null,comingFromRow:0,comingFromColumn:"",uniqueFigure:!1,promoteTo:null,number:s};a.isDone=!1;var n="w"===o?e.w:e.b;if(n=n.replace(/\?|!/,""),a.moveType="move",-1!==n.indexOf("x")&&(n=n.replace("x",""),a.moveType="take"),"+"===n.charAt(n.length-1)&&"+"===n.charAt(n.length-2)?(a.isMat=!0,n=n.substring(0,n.length-2)):"+"===n.charAt(n.length-1)&&(a.isCheck=!0,n=n.substring(0,n.length-1)),2===n.length)a.movePieceType="p",a.moveColumn=n.charAt(0),a.moveRow=parseInt(n.charAt(1)),isNaN(a.moveRow)&&(a.isError=!0);else if(3===n.length)"0-0"===n||"O-O"===n?(a.movePieceType="K",a.moveColumn="g",a.moveRow="w"===a.moveSide?1:8,a.moveType="castle-king",a.possiblePositions=[],a.additionalMove={moveSide:a.moveSide,moveColumn:"f",moveRow:a.moveRow,movePieceType:"R",moveType:a.moveType,isCheck:!1,isError:!1,possiblePositions:[]}):(R(n.charAt(0))?(a.movePieceType="p",a.comingFromColumn=n.charAt(0),a.moveColumn=n.charAt(1),a.moveRow=parseInt(n.charAt(2))):(a.movePieceType=n.charAt(0),a.moveColumn=n.charAt(1),a.moveRow=parseInt(n.charAt(2))),isNaN(a.moveRow)&&(a.isError=!0));else if(4===n.length)if("="===n.charAt(2))a.promoteTo=n.charAt(3),a.movePieceType="p",a.moveColumn=n.charAt(0),a.moveRow=parseInt(n.charAt(1));else{a.movePieceType=n.charAt(0);var r=n.charAt(1);isNaN(parseInt(r))?a.comingFromColumn=r:a.comingFromRow=parseInt(r),a.moveColumn=n.charAt(2),a.moveRow=parseInt(n.charAt(3)),isNaN(a.moveRow)&&(a.isError=!0)}else"0-0-0"===n||"O-O-O"===n?(a.movePieceType="K",a.moveColumn="c",a.moveRow="w"===a.moveSide?1:8,a.moveType="castle-queen",a.possiblePositions=[],a.additionalMove={moveSide:a.moveSide,moveColumn:"d",moveRow:a.moveRow,movePieceType:"R",moveType:a.moveType,isCheck:!1,isError:!1,possiblePositions:[]}):a.isError=!0;return a.isError||(a.possiblePositions=[],"p"===a.movePieceType?N(a,t):"N"===a.movePieceType?T(a,t):"B"===a.movePieceType?y(a,t):"R"===a.movePieceType?S(a,t):"K"===a.movePieceType?x(a,t):"Q"===a.movePieceType&&(a.uniqueFigure=!0)),a}(e,s,o+1,0,l);c=function(e,o){if(!e.isError&&!e.isDone){var s=!1;if(e.possiblePositions&&e.possiblePositions.length>0){for(var i=0;i<e.possiblePositions.length&&!s;i++)for(var t=0;t<o.length;t++)if(o[t].column===e.possiblePositions[i].column&&o[t].row===e.possiblePositions[i].row&&o[t].fig===e.movePieceType+e.moveSide.toUpperCase()){s=!0,o[t].fig=null;break}if(null!==e.additionalMove){for(var a=s,n=!1,r=0;r<o.length;r++)o[r].column===e.additionalMove.possiblePositions[0].column&&o[r].row===e.additionalMove.possiblePositions[0].row&&o[r].fig===e.additionalMove.movePieceType+e.additionalMove.moveSide.toUpperCase()&&(n=!0,o[r].fig=null);s=a&&n}}if(!0===e.uniqueFigure)for(var m=0;m<o.length;m++)if(o[m].fig===e.movePieceType+e.moveSide.toUpperCase()){s=!0,o[m].fig=null;break}if(s){for(var c=0;c<o.length;c++)if(o[c].column===e.moveColumn&&o[c].row===e.moveRow){"take"===e.moveType?(null===o[c].fig&&"p"===e.movePieceType&&(o[c+("w"===e.moveSide?8:-8)].fig=null),o[c].fig=e.movePieceType+e.moveSide.toUpperCase()):o[c].fig=e.promoteTo?e.promoteTo+e.moveSide.toUpperCase():e.movePieceType+e.moveSide.toUpperCase();break}if(null!=e.additionalMove)for(var l=0;l<o.length;l++)if(o[l].column===e.additionalMove.moveColumn&&o[l].row===e.additionalMove.moveRow){o[l].fig=e.additionalMove.movePieceType+e.additionalMove.moveSide.toUpperCase();break}}}return o}(i,c);var t=k(c,i,l);t&&m.push({number:i.number,side:i.moveSide,fen:t})}}))}));var u={pgnHistory:s,pgnResume:n,pgnGame:r,fenGame:m};e.saveGameToStorage(u),e.state.games.push(u);var v={data:JSON.parse(e.state.initialData),pgnResume:n,pgnHistory:s,pgnGame:r,fenGame:m,move:{number:0,side:"w"},scores:{whiteScore:0,blackScore:0,whiteJail:[],blackJail:[]}};e.setGameStatus(e.gameStatus.showList,"",v)}else e.setGameStatus(e.gameStatus.inError,"unable to read this png")}},e.saveGameToStorage=function(o){e.setGameStatus(e.gameStatus.showMessage,"Saving analyzed game");var s=[];null!==localStorage.getItem("games")?0===(s=JSON.parse(localStorage.getItem("games"))).filter((function(e){return e.pgnGame===o.pgnGame})).length?s.push(o):s.forEach((function(e){e.pgnGame===o.pgnGame&&(e.pgnHistory=o.pgnHistory,e.pgnResume=o.pgnResume,e.fenGame=o.fenGame)})):s.push(o);localStorage.setItem("games",JSON.stringify(s))},e.setGameStatus=function(o,s,i){var t="";switch(o){case e.gameStatus.showInput:t={title:"Please enter a game in PGN format",message:""};break;case e.gameStatus.init:t={title:"New game saved",message:"analysing PGN game..."};break;case e.gameStatus.showMoves:t={title:"Game's moves",message:""};break;case e.gameStatus.showList:t={title:"Choose from list",message:""};break;case e.gameStatus.showMessage:t={title:"Current status",message:s};break;case e.gameStatus.inError:t={title:"Error !",message:s};break;default:t={title:"Error !",message:"the program is in error..."}}var a={status:o,infosTitle:t.title,infosMessage:t.message};if(i)for(var n in i)a[n]=i[n];e.setState((function(e,o){return a}))},e.initGames=function(){e.setState((function(o,s){return{status:e.gameStatus.init}}));var o=void 0!==window.database?window.database:null,s=[];o?s=o.ref("Games"):null!==localStorage.getItem("games")&&(s=JSON.parse(localStorage.getItem("games")));var i=e.gameStatus.showInput;s.length>0&&(i=e.gameStatus.showList);for(var t,a=e.state.pgnHistory,n=[],r=[],m=e.state.blackColor,c=e.state.whiteColor,l=e.state.black,u=e.state.white,v=c,g=0,d=0,p=0,h=7;h>=0;h--){g=e.state.rows[h];for(var b=0;b<8;b++)d=e.state.columns[b],++p%8===1?t=v:v=t=v===m?c:m,n.push({row:g,column:d,squareColor:t,fig:null})}e.state.figures.forEach((function(o,s){r.push({row:e.state.rows[0],column:e.state.columns[s],fig:o+u}),r.push({row:e.state.rows[1],column:e.state.columns[s],fig:e.state.pawn+u}),r.push({row:e.state.rows[6],column:e.state.columns[s],fig:e.state.pawn+l}),r.push({row:e.state.rows[7],column:e.state.columns[s],fig:o+l})})),n.forEach((function(e){var o=r.filter((function(o){return o.row===e.row&&o.column===e.column}));1===o.length&&(e.fig=o[0].fig)}));var f={games:s,status:i,data:n,initialData:JSON.stringify(n),positions:r,move:{number:0,side:"w"},pgnHistory:a,scores:{whiteScore:0,blackScore:0,whiteJail:[],blackJail:[]}};e.setGameStatus(i,"",f)},e.gameStatus={init:0,showList:1,showInput:2,showMoves:3,showMessage:4,inError:-1},e.state={database:null,games:[],scores:{whiteScore:0,blackScore:0,whiteJail:[],blackJail:[]},gameKey:0,doReverseBoard:!1,proposeSave:!1,status:e.gameStatus.init,readerStop:!1,initialData:null,gameIsReady:!1,infosTitle:"",infosMessage:"",msg:"White to play",data:[],pgnHistory:"",move:{number:0,side:"b"},pgnResume:[],pgnGame:[],fenGame:[{number:0,side:"w",fen:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"}],positions:[],columns:"a,b,c,d,e,f,g,h".split(","),rows:[1,2,3,4,5,6,7,8],figures:"R,N,B,Q,K,B,N,R".split(","),pawn:"p",black:"B",white:"W",blackColor:"dark-square",whiteColor:"light-square",nrSquaresPerside:8,figCodes:{KB:"&#9818;",QB:"&#9819;",RB:"&#9820;",BB:"&#9821;",NB:"&#9822;",pB:"&#9823;",KW:"&#9812;",QW:"&#9813;",RW:"&#9814;",BW:"&#9815;",NW:"&#9816;",pW:"&#9817;"}},e}return Object(u.a)(s,[{key:"componentDidMount",value:function(){this.initGames()}},{key:"render",value:function(){return this.state.status===this.gameStatus.showInput?Object(m.jsxs)("div",{className:"game",children:[Object(m.jsx)("div",{className:"game-board",children:Object(m.jsx)(f,{reverseBoard:this.reverseBoard,game:this.state},1)}),Object(m.jsx)("div",{className:"game-info",children:Object(m.jsx)(O,{game:this.state,movePGN:this.movePGN,menuMove:this.menuMove,savePGN:this.savePGN,statuses:this.gameStatus},1)})]}):this.state.status===this.gameStatus.showList?Object(m.jsxs)("div",{className:"game",children:[Object(m.jsx)("div",{className:"game-board",children:Object(m.jsx)(f,{reverseBoard:this.reverseBoard,game:this.state},1)}),Object(m.jsx)("div",{className:"game-info",children:Object(m.jsx)(O,{game:this.state,loadGame:this.loadGame,deleteGame:this.deleteGame,menuMove:this.menuMove,statuses:this.gameStatus},1)})]}):this.state.status===this.gameStatus.showMoves?Object(m.jsxs)("div",{className:"game",children:[Object(m.jsx)("div",{className:"game-board",children:Object(m.jsx)(f,{reverseBoard:this.reverseBoard,game:this.state},1)}),Object(m.jsx)("div",{className:"game-info",children:Object(m.jsx)(O,{game:this.state,movePGN:this.movePGN,menuMove:this.menuMove,savePGN:this.savePGN,statuses:this.gameStatus},1)})]}):this.state.status===this.gameStatus.showMessage?Object(m.jsx)("div",{className:"game",children:Object(m.jsxs)("div",{children:[Object(m.jsxs)("h1",{children:[" ",this.state.infosTitle," "]}),Object(m.jsxs)("p",{children:[" ",this.state.infosMessage," "]})]})}):Object(m.jsx)("div",{className:"game",children:Object(m.jsx)("h1",{children:" Loading "})})}}]),s}(t.a.Component);var F=function(){return Object(m.jsxs)("div",{className:"App",children:[Object(m.jsx)(c,{}),Object(m.jsx)(G,{})]})};n.a.render(Object(m.jsx)(F,{}),document.getElementById("root"))}],[[26,1,2]]]);
//# sourceMappingURL=main.9b151052.chunk.js.map